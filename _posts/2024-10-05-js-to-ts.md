---
title: JS to TS (Node.js)
author: Psmin
data: 2024-10-05 19:43:51 +0900
categories: [Knowledge, Typescript]
tags: [Typescript]
---

# JS to TS

JavaScript 프로젝트를 TypeScript로 마이그레이션 해보자.

---

## TypeScript 환경 설정

- **TypeScript** 의존성 설치

  ```console
  npm i -D typescript
  ```

- **tsconfig.json** 파일 생성

  ```json
  {
    "compilerOptions": {
      // 기본 출력 설정
      "target": "ESNext", // 컴파일된 JS 코드 ES 버전
      "module": "ESNext", // 모듈 시스템
      "outDir": "./dist", // 컴파일된 파일 출력 디렉토리
      "rootDir": "./src", // 루트 디렉토리
      "sourceMap": false,

      // strict 타입 검사
      "strict": true, // 엄격 모드

      // 파일 킻 경로 설정
      "baseUrl": "src", // import 경로
      "esModuleInterop": true,

      // 기타 옵션
      "skipLibCheck": true,
      "allowJs": true,
      "checkJs": false, // js 파일 타입 검사 여부
      "forceConsistentCasingInFileNames": true, // 파일 이름 대소문자 구분
      "moduleDetection": "auto",
      "moduleResolution": "node"
    },

    "include": ["./src/**/*"],

    "exclude": [
      "node_modules", // 외부 라이브러리 제외
      "**/*.test.ts" // 테스트 파일 제외
    ]
  }
  ```

## nodemon.json 파일 생성

> 참고글 : [nodemon.json](https://psmin1994.github.io/posts/nodemon-json/)

```json
{
  "exec": "tsc && node app.js",
  "watch": ["src"],
  "ext": "js,ts,json",
  "ignore": ["node_modules", "dist"],
  "delay": "1000",
  "restartable": "rs",
  "verbose": true
}
```

---

`tsc && node app.js`

- **tsc** : TypeScript 컴파일러(tsc)를 실행하여 ts 파일을 js 파일로 변환합니다.

- **node app.js** : 컴파일된 결과로 실행 가능한 JavaScript 파일을 Node.js를 사용하여 실행합니다.

---

## 변환 과정

- `.js` 파일을 `.ts` 파일로 변환합니다.

- **타입 정의 추가**

  JavaScript 코드에서는 동적 타입이였지만, TypeScript는 강력한 정적 타입을 요구합니다.

  ```ts
  // 예시
  let userName: string = "John Doe";

  const sum = (a: number, b: number): number => {
    return a + b;
  };
  ```

- **외부 라이브러리 타입 정의**

  외부 라이브러리를 사용하고 있다면, 해당 라이브러리의 타입 정의 파일을 설치해야 사용할 수 있습니다.

  > 타입 정의 파일이 없을 경우, 직접 작성해야함

  ```console
  npm i -D @types/express
  ```

---

## 점진적인 마이그레이션

처음부터 모든 파일을 TypeScript로 변환하지 않고, JavaScript 파일을 점진적으로 변환합니다.

```json
// tsconfig.json
{
  "compilerOptions": {
    "allowJs": true, // JS 파일을 컴파일에 포함
    "checkJs": false // JS 파일에서 타입 검사를 비활성화
  }
}
```

타입 정의 단계에서 처음에는 `any`로 타입을 설정한 후 하나씩 변환해나갑니다.

```ts
// JavaScript (변경 전)
function add(a, b) {
  return a + b;
}

// 점진적 변경
function add(a: any, b: any): any {
  return a + b;
}

// TypeScript (변경 후)
function add(a: number, b: number): number {
  return a + b;
}
```

---

## ts-migrate

JavaScript 프로젝트를 TypeScript로 마이그레이션하는 과정을 자동화하고 간소화하는 도구입니다.

- **설치**

  ```console
  npm i ts-migrate
  ```

---

### 주요 기능

- **TypeScript로 파일 변환**

  `.js` 파일을 `.ts` 또는 `.tsx`로 변환합니다.

  TypeScript가 요구하는 기본적인 문법 변환 작업을 수행합니다.

- **@ts-ignore 주석 추가**

  TypeScript 컴파일 오류를 방지하기 위해 필요한 위치에 `@ts-ignore` 또는 `any` 타입을 추가합니다.

  초기 전환 단계에서 컴파일러의 오류를 무시하고 실행 가능한 상태를 유지합니다.

- **TypeScript 구성 파일 생성**

  `tsconfig.json` 파일을 자동 생성하거나 업데이트하여 프로젝트의 TypeScript 설정을 제공합니다.

- **점진적 마이그레이션 지원**

  모든 파일을 한 번에 마이그레이션할 필요 없이, 파일 단위로 점진적으로 TypeScript로 전환할 수 있습니다.

---

### 사용법

```bash
ts-migrate migrate <directory>
```

지정한 디렉토리의 파일을 TypeScript로 변환합니다.

변환 후, 자동으로 추가된 `@ts-ignore` 주석과 타입을 점검하고 수동으로 타입 정의를 개선합니다.

---

### 예시

```ts
// Before: App.js
function App() {
  return <div>Hello, world!</div>;
}

export default App;

---

// After: App.tsx
// @ts-ignore
function App(): any {
  return <div>Hello, world!</div>;
}

export default App;

// 점진적 개선
// App.tsx
import React from 'react';

function App(): JSX.Element {
  return <div>Hello, world!</div>;
}

export default App;
```
