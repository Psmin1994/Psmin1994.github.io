---
title: MVC 패턴
author: Psmin
data: 2022-01-02 14:13:21 +0900
categories: [Nodejs]
tags: [MVC]
---

# MVC 패턴을 적용한 express 서버를 구현해보자.

---

## MVC 패턴

모델-뷰-컨트롤러 (Model-View-Controller, MVC) 는 소프트웨어 디자인 패턴입니다.

비즈니스 로직을 분리해 서로 영향없이 유지보수할 수 있는 애플리케이션을 만들 수 있습니다.

- Model : 데이터 관련 작업 담당
- View : 사용자 인터페이스 담당
- Controller : 데이터 (Model)과 사용자 인터페이스 (View) 요소 연결 담당

---

## View 설정

간단한 로그인 시스템이므로 View는 ejs 모듈로 가볍게 설정하겠습니다.

먼저 서버 코드 app.js에 view engine을 설정합니다.

```js

```

---

## Router 설정

Router는 특정 주소로 요청이 들어오면 주소와 HTTP method 별로 Controller와 연결하는 역활을합니다.

또한, 요청과 함께 받은 데이터들의 유효성 검사 등도 Router에서 담당합니다.

routes 폴더를 만들고 route-login.js파일을 만들어 express router를 작성합니다.

```js
import express from "express";
import login_ctrl from "../controller/controller-login.js";

const loginRouter = express.Router();

loginRouter.get("/login", login_ctrl.output.login);
loginRouter.get("/register", login_ctrl.output.register);

loginRouter.post("/login", login_ctrl.process.login);
loginRouter.post("/register", login_ctrl.process.register);

export default loginRouter;
```

서버 파일인 app.js와 라우터 파일 route-login.js 파일을 미들웨어로 연결합니다.

```js
import express from "express";
import bodyParser from "body-parser";
import path from "path";
import morganMiddleware from "./src/config/morgan.js";
import loginRouter from "./src/routes/route-login";

const app = express();
const __dirname = path.resolve();

app.use("/", express.static(`${__dirname}/src/public`));

app.use(bodyParser.json());
app.use(bodyParser.urlencoded({ extended: true }));

app.use(morganMiddleware);

// router
app.use("/user", loginRouter);

// 3000 포트로 서버 오픈
app.listen(3000, () => {
  console.log("express server on port 3000");
});
```

---

## Controller 설정

Controller는 요청을 처리하고 응답하는 역할을 합니다.

Model과 View 간의 중간 다리 역할로 필요에따라 Model과 소통하여 받은 데이터를 View(클라이언트)로 응답합니다.

controllers 폴더를 만들고 controller-login.js 파일에 output, process 객체로 나누어 기본 틀을 작성해보겠습니다.

```js
import model_login from "../models/model.login";

const output = {
  home: (req, res) => {
    res.render(...);
  },

  register: (rea, res) => {
    res.render(...);
  },
};

const process = {
  login: (req, res) => {
    model_login.login(...);

    ...

    res.render(...);
  },

  register: (req, res) => {
    model_login.register(...);

    ...

    res.render(...);
  },
};
```

---

## Models 설정

Model은 Controller로 부터 요청을 받아 데이터베이스에 접근해 CRUD 로직을 처리합니다.

mysql2 모듈의 createPool을 활용해보겠습니다.

```js

```

---

## 참조
