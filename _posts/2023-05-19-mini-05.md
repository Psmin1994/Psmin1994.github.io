---
title: 미니 블로그 만들기 - 05
author: Psmin
data: 2023-05-19 23:01:54 +0900
categories: [Project, Mini Blog]
tags: [React, Axios]
---

## Axios 설치

서버에 데이터를 요청하기 위해서는 HTTP 통신을 해야합니다.

React에는 HTTP 통신을 위한 내장 클래스가 존재하지 않기 떄문에 <u>XMLRequest, fetch, Axios 등을 사용하여 AJAX를 구현</u>합니다.

이번엔 Axios를 사용해서 서버에 데이터를 요청해보겠습니다.

- **설치**

  ```
  npm i axios
  ```

---

## Axios로 서버에 데이터 요청

기존에는 **_data.json_** 파일 import해서 글 데이터를 **PostList 컴포넌트**에 념겨줬습니다.

```js
// BoardPage.jsx
import React from "react";
import { styled } from "@mui/material/styles";
import BasicButton from "../ui/BasicButton";
import { useNavigate } from "react-router-dom";
import PostList from "../list/PostList";
import data from "../../data.json";

const BtnWrapper = styled.div`
  margin-left: auto;
`;

const MainPage = () => {
  const navigate = useNavigate();

  return (
    <>
      <BtnWrapper>
        <BasicButton
          title={"글 작성하기"}
          onClickItem={() => navigate("/post-write")}
        ></BasicButton>
      </BtnWrapper>

      <PostList
        posts={data}
        onClickItem={(item) => {
          navigate(`/post/${item.id}`);
        }}
      ></PostList>
    </>
  );
};

export default MainPage;
```

이번에는 axios를 활용해 서버에 글 데이터를 요청해보겠습니다.

> 참고 글 : [Axios](https://psmin1994.github.io/posts/axios/), [Hook](https://psmin1994.github.io/posts/Hook/)

- **변경할 내용**

  - **_data.json_** 대신 Axios로 서버에서 데이터 얻기
  - 가져온 데이터 **State로 관리**
  - 컴포넌트가 Mount 될 때만 데이터 가져오도록 **useEffect 사용**
  - **await / async 문 사용**
  - **try / catch 문 사용**

```js
import React, { useEffect, useState } from "react";
import { useNavigate } from "react-router-dom";
import PostList from "../list/PostList";
import { styled } from "@mui/material/styles";
import BasicButton from "../ui/BasicButton";
import axios from "axios"; // data.json 대신 axios 사용

const BtnWrapper = styled("div")`
  margin-left: auto;
`;

const BoardPage = () => {
  const navigate = useNavigate();
  let [data, setData] = useState([]); // 가져올 데이터 담을 변수

  useEffect(() => {
    let getPosts = async () => {
      try {
        let res = await axios.get("/board/post");

        return res.data;
      } catch (err) {
        console.log(err);
      }
    };

    getPosts().then((res) => setData(res));
  }, []); // 빈 배열로 컴포넌트가 Mount 될 때만 작동

  return (
    <>
      <BtnWrapper>
        <BasicButton
          title={"글 작성하기"}
          onClickItem={() => navigate("/board/write")}
        ></BasicButton>
      </BtnWrapper>

      <PostList
        posts={data}
        onClickItem={(item) => {
          navigate(`/board/${item.post_id}`, { state: { item } });
        }}
      ></PostList>
    </>
  );
};

export default BoardPage;
```

---

## MainPage 수정

기존에는 **_data.json_** 파일 import해서 글 데이터를 **PostList 컴포넌트**에 념겨줬습니다.

```jsx
import React from "react";
import { useNavigate } from "react-router-dom";
import { styled } from "@mui/material/styles";
import BasicButton from "../ui/BasicButton";
import PostList from "../list/PostList";
import data from "../../data.json";

const BtnWrapper = styled("div")`
  margin-left: auto;
`;

const MainPage = () => {
  const navigate = useNavigate();

  return (
    <>
      <BtnWrapper>
        <BasicButton
          title={"글 작성하기"}
          onClickItem={() => navigate("/post/write")}
        ></BasicButton>
      </BtnWrapper>

      <PostList
        posts={data}
        onClickItem={(item) => {
          navigate(`/post/${item.id}`);
        }}
      ></PostList>
    </>
  );
};

export default MainPage;
```
