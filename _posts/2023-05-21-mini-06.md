---
title: 미니 블로그 만들기 - 06
author: Psmin
data: 2023-05-21 16:37:32 +0900
categories: [Project, Mini Blog]
tags: [React, Axios]
---

## Custom Hook

- 여러 <u>컴포넌트에서 공통적으로 사용되는 상태 로직을 추출하여 하나의 함수로 만들어 사용</u>
- <u>use라는 접두사를 사용하여 함수의 이름을 정의</u>
- <u>React의 기본 훅(useState, useEffect 등)을 이용하여 구현</u>

즉, **React에서 반복되는 로직을 Component**로 만들어 사용했던 것처럼 **반복되는 메서드를 Custom Hook**으로 만들어 사용하는 것입니다.

- **장점**

  - 코드가 간결해지고 **가독성**이 좋아집니다.
  - 반복이 줄어 **재사용성**이 높아집니다.
  - **유지보수** 용이

---

## 반복되는 코드

```js
// BoardPage.jsx
import React, { useEffect, useState } from "react";
import { styled } from "@mui/material/styles";
import { useNavigate } from "react-router-dom";
import BasicButton from "../ui/BasicButton";
import PostList from "../list/PostList";
import axios from "axios";

const BtnWrapper = styled("div")`
  margin-left: auto;
`;

const BoardPage = () => {
  const navigate = useNavigate();
  // *******************************************
  // axios로 데이터를 받아오는 코드
  let [data, setData] = useState([]);

  useEffect(() => {
    let getPosts = async () => {
      try {
        let res = await axios.get("/board/post");

        return res.data;
      } catch (err) {
        console.log(err);
      }
    };

    getPosts().then((res) => setData(res));
  }, []);

  // *******************************************

  return (
    <>
      <BtnWrapper>
        <BasicButton
          title={"글 작성하기"}
          onClickItem={() => navigate("/board/write")}
        ></BasicButton>
      </BtnWrapper>

      <PostList
        posts={data}
        onClickItem={(item) => {
          navigate(`/board/${item.post_id}`);
        }}
      ></PostList>
    </>
  );
};

export default BoardPage;
```

위 코드처럼 axios를 이용해 서버에 데이터를 요청하는 코드는 현재 모든 **Page 컴포넌트**에서 사용합니다.

또한, 기능이 추가되면 <u>axios의 사용은 더 늘어날 것</u>입니다.

따라서, **Custom Hook**으로 만들어서 사용해보겠습니다.

---

## useAxios

src 폴더에 hooks 폴더를 만들고 **_useAxios.js_** 파일을 생성합니다.

```js
// useAxios.js
import axios from "axios";
import { useState, useEffect, useMemo } from "react";

const useAxios = (reqConfig) => {
  const localReqConfig = useMemo(() => {
    return reqConfig || {};
  }, [reqConfig]);

  if (!localReqConfig?.method) {
    localReqConfig.method = "get";
  }

  let [data, setData] = useState([]); // 가져올 데이터 담을 변수

  useEffect(() => {
    let getPosts = async () => {
      try {
        const res = await axios(localReqConfig);

        return res.data;
      } catch (err) {
        console.log(err);
      }
    }; // try / catch 문으로 에러 처리를 하며 axios를 이용해 서버에서 데이터를 가져옵니다.

    getPosts().then((res) => setData(res));
    // 가져온 데이터를 state로 관리합니다.
  }, [localReqConfig]); // 빈 배열로 컴포넌트가 Mount 될 때만 작동합니다.

  return data;
};

export default useAxios;
```
